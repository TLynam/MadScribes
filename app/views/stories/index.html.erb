<div class="home_header">
  <h1>Create stories with friends in real time</h1>

  <%= image_tag("header.jpg") %> </br>

  <div class="col-sm-12">
    <h4>
      The game is simple, yet really fun! Each round you submit a sentence. Then everyone votes on the sentence they like the best and the winning sentence is added to the story. You recieve a point for each vote.
    </h4>
  </div>

  <div class="col-sm-12">
    <%= link_to "Create Story", new_story_path, class: "btn btn-success", style: "margin-top: 15px; margin-bottom: 15px;" %>
  </div>
</div>

<div class="col-sm-12">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Waiting to Start</h3>
    </div>
    <div class="panel-body">
      <% if @pending_stories.none? %>
        <h4>You can start a story :)</h4>
      <% end %>
      <div class="table-responsive">
        <table class="table table-hover" style="cursor:pointer;">
          <thead>
            <tr>
              <th>Story</th>
              <th>Subscribers (count)</th>
            </tr>
          </thead>
          <tbody>
            <% @pending_stories.each do |story| %>
              <tr <%= "class=success" if story.user == current_user %> data-link="<%= story_url(story) %>" >
                <td><%= story.title %></td>
                <td>
                  (<%= story.subscriptions.count %>)
                  <%= story.subscriptions.map{|subscription| subscription.user.display_name}.to_sentence %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
    <%= will_paginate @pending_stories, renderer: BootstrapPagination::Rails %>
  </div>
</div>

<div class="col-sm-12">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Active Stories</h3>
    </div>
    <div class="panel-body">
      <% if @live_stories.none? %>
        <h4>You can start a story :)</h4>
      <% end %>
      <ul style="margin-top:20px;">
        <% @live_stories.each do |story| %>
          <li><%= link_to story.title, story %></li>
        <% end %>
      </ul>

      <%= will_paginate @live_stories, renderer: BootstrapPagination::Rails %>
    </div>
  </div>
</div>

<div class="col-sm-12">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">All Stories</h3>
    </div>
    <div class="panel-body">
      <div class="form-inline">
        <%= form_tag("/", method: "get") do %>
          <div class="field form-group">
            <%= label_tag(:q, "Search:", class: "control-label") %>
            <%= text_field_tag(:q, nil, class: "form-control") %>
          </div>
          <div class="actions form-group">
            <%= submit_tag("Search", class: "btn btn-success") %>
          </div>
        <% end %>
      </div>
      <ul style="margin-top:20px;">
        <% @stories.each do |story| %>
          <li><%= link_to story.title, story %></li>
        <% end %>
      </ul>

      <%= will_paginate @stories, renderer: BootstrapPagination::Rails %>
    </div>
  </div>
</div>


<div class="col-sm-12">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Leaderboard</h3>
    </div>
    <div class="panel-body">
      <div class="sentence_container">
        <div class="table-responsive">
          <table class="table table-hover" style="cursor:pointer;">
            <thead>
              <tr>
                <th>Score</th>
                <th>Author</th>
              </tr>
            </thead>
            <tbody>
              <% User.all.sort_by {|user| user.score}.reverse.take(15).each do |user| %>
                <tr <%= "class=success" if user == current_user %> data-link="<%= user_url(user) %>" >
                  <td><%= user.score %></td>
                  <td><%= user.display_name %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
